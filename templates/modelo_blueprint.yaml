# ===============================================================
# MODELO_BLUEPRINT.yaml
# ===============================================================
# Template de metadados estruturados para blueprints técnicos
# Consumível por IAs, pipelines CI/CD e sistemas de auditoria
# ===============================================================

# ===============================================================
# INSTRUÇÕES DE PREENCHIMENTO
# ===============================================================
# 1. Substitua <PLACEHOLDERS> pelos valores específicos do blueprint
# 2. Este YAML acompanha o arquivo .md correspondente
# 3. Use o DockManager Blueprint como exemplo prático
# 4. Mantenha sincronizado com o arquivo .md

# ===============================================================
# METADADOS BÁSICOS
# ===============================================================
framework_name: "CrisAI"
framework_acronym: "CRIS"
framework_meaning: "Cognitive Responsible Innovation System"
framework_tagline: "Inovação Cognitiva com Responsabilidade e Propósito"
framework_version: "1.4" 
framework_named_for: "Cris Vicenzo"
blueprint_metadata:
  version: "v<X.Y>"
  document_type: "blueprint_tecnico"
  created_at: "<YYYY-MM-DD>"
  last_updated: "<YYYY-MM-DD>"
  status: "draft"  # draft | approved | implemented | deprecated

# ===============================================================
# IDENTIFICAÇÃO DO PROJETO E FASE
# ===============================================================
project:
  name: "<NOME_DO_PROJETO>"
  code: "<CODIGO_INTERNO>"
  version: "v<VERSAO>"
  phase: "<FASE_OU_MODULO>"
  
references:
  ssot_master: "<PROJETO>_CONCEITO_TECH.md"
  protocol: "PROTOCOLO_GOVERNANCA_IA_HUMANO_<PROJETO>_v<X.Y>.md"
  manifesto_corporate: "MANIFESTO_GOVERNANCA_v1.4.yaml"
  manifesto_project: "<MANIFESTO_<PROJETO>_vX.Y.yaml ou null>"

# ===============================================================
# ESCOPO E PROPÓSITO
# ===============================================================
scope:
  purpose: "<Descreva o propósito desta fase/módulo>"
  objectives:
    - "<Objetivo 1>"
    - "<Objetivo 2>"
    - "<Objetivo 3>"
  
  business_value: "<Qual valor de negócio esta fase entrega?>"
  
  example_dockmanager: |
    Implementar o Pilar 1 do DockManager: Motor de Workflows executável,
    modular e auditável com SLA, escalonamento e observabilidade.

# ===============================================================
# COMPONENTES PRINCIPAIS (ARQUITETURA FUNCIONAL)
# ===============================================================
components:
  - name: "<COMPONENTE_1>"
    description: "<Descrição da responsabilidade>"
    type: "<tipo: core|service|integration|utility>"
    dependencies: []
  
  - name: "<COMPONENTE_2>"
    description: "<Descrição da responsabilidade>"
    type: "<tipo>"
    dependencies: ["<COMPONENTE_1>"]
  
  - name: "<COMPONENTE_3>"
    description: "<Descrição da responsabilidade>"
    type: "<tipo>"
    dependencies: []

# Exemplo DockManager
example_components:
  - name: "Engine Core"
    description: "Execução de workflows, orquestração de nodes e estados"
    type: "core"
    dependencies: []
  
  - name: "EventBus"
    description: "Publicação/assinatura de eventos e integração assíncrona"
    type: "service"
    dependencies: ["Engine Core"]
  
  - name: "Audit Layer"
    description: "Trilhas de auditoria, SHA256 e retenção"
    type: "utility"
    dependencies: ["Engine Core", "EventBus"]

# ===============================================================
# BLOCOS TÉCNICOS IMPLEMENTÁVEIS (#BLOCK)
# ===============================================================
blocks:
  - id: "<BLOCK_1>"
    name: "<NOME_DO_BLOCO>"
    description: "<Propósito do bloco>"
    ia_responsible: "<IA_Developer|IA_<Especializada>>"
    dependencies: []
    max_duration_hours: 16
    priority: "high"  # high | medium | low
    status: "pending"  # pending | in_progress | completed | blocked
  
  - id: "<BLOCK_2>"
    name: "<NOME_DO_BLOCO_2>"
    description: "<Propósito do bloco>"
    ia_responsible: "<IA_Role>"
    dependencies: ["<BLOCK_1>"]
    max_duration_hours: 12
    priority: "medium"
    status: "pending"

# Exemplo DockManager
example_blocks:
  - id: "BLOCK_ENGINE_CORE"
    name: "Motor de Execução de Workflows"
    description: "Implementar engine core com node manager, state store e SLA controller"
    ia_responsible: "IA_Developer"
    dependencies: []
    max_duration_hours: 16
    priority: "high"
    status: "completed"
  
  - id: "BLOCK_EVENT_BUS"
    name: "Barramento de Eventos"
    description: "Implementar pub/sub com RabbitMQ, retry e dead letter queue"
    ia_responsible: "IA_Developer"
    dependencies: ["BLOCK_ENGINE_CORE"]
    max_duration_hours: 12
    priority: "high"
    status: "completed"
  
  - id: "BLOCK_AUDIT_LAYER"
    name: "Camada de Auditoria"
    description: "Implementar logging imutável com SHA256 e retenção de 5 anos"
    ia_responsible: "IA_Developer"
    dependencies: ["BLOCK_ENGINE_CORE", "BLOCK_EVENT_BUS"]
    max_duration_hours: 8
    priority: "medium"
    status: "completed"

# ===============================================================
# TOPOLOGIA E ARQUITETURA TÉCNICA
# ===============================================================
topology:
  <componente_1>:
    description: "<descrição>"
    submodules: ["<sub1>", "<sub2>"]
    tech_stack: "<tecnologias>"
  
  <componente_2>:
    type: "<tipo>"
    tech_options: ["<opção1>", "<opção2>"]
    guarantees: ["<garantia1>", "<garantia2>"]
    scaling: "<horizontal|vertical>"

# Exemplo DockManager
example_topology:
  engine_core:
    description: "Execução de workflows e nodes"
    submodules: ["node_manager", "state_store", "sla_controller"]
    tech_stack: "Node.js + NestJS"
  
  event_bus:
    type: "pubsub"
    tech_options: ["RabbitMQ", "Kafka"]
    guarantees: ["at-least-once", "retry-with-backoff"]
    scaling: "horizontal"
  
  audit_layer:
    hashing: "SHA256"
    retention_years: 5
    tech_stack: "PostgreSQL + Time-series optimization"

# ===============================================================
# MODELAGEM TÉCNICA (ENTIDADES E APIs)
# ===============================================================
data_model:
  entities:
    - name: "<entidade_1>"
      fields: ["<campo1>", "<campo2>", "<campo3>"]
      relationships: ["<relacionamento>"]
    
    - name: "<entidade_2>"
      fields: ["<campo1>", "<campo2>"]
      relationships: []

# Exemplo DockManager
example_data_model:
  entities:
    - name: "workflow"
      fields: ["id", "name", "tenant_id", "version", "status", "created_at"]
      relationships: ["has_many:nodes", "has_many:executions"]
    
    - name: "node"
      fields: ["id", "workflow_id", "type", "config", "position"]
      relationships: ["belongs_to:workflow"]
    
    - name: "execution"
      fields: ["id", "workflow_id", "input_payload", "status", "started_at"]
      relationships: ["belongs_to:workflow"]

api_endpoints:
  - method: "<METHOD>"
    path: "/api/<recurso>"
    description: "<descrição>"
    auth_required: true
  
  - method: "<METHOD>"
    path: "/api/<recurso>/{id}"
    description: "<descrição>"
    auth_required: true

# Exemplo DockManager
example_api_endpoints:
  - method: "POST"
    path: "/api/workflows"
    description: "Criar/atualizar workflow"
    auth_required: true
  
  - method: "POST"
    path: "/api/workflows/{id}/execute"
    description: "Executar workflow"
    auth_required: true
  
  - method: "GET"
    path: "/api/executions/{id}"
    description: "Consultar execução"
    auth_required: true

# ===============================================================
# INTEGRAÇÃO COM SISTEMAS EXTERNOS
# ===============================================================
integrations:
  connectors:
    - type: "API_REST"
      auth: "OAuth2/JWT"
      purpose: "<Descrição>"
    
    - type: "DATABASE"
      technology: "<PostgreSQL|MySQL|MongoDB>"
      purpose: "<Descrição>"
    
    - type: "MESSAGING"
      technology: "<Kafka|RabbitMQ|Redis>"
      purpose: "<Descrição>"

# ===============================================================
# AUDITORIA E RASTREABILIDADE
# ===============================================================
auditability:
  immutability:
    method: "SHA256(payload+timestamp)"
    storage: "append-only logs"
  
  retention:
    default_years: "<X>"
    configurable: true
    backup_frequency: "<diário|semanal|mensal>"
  
  reconciliation:
    enabled: true
    frequency: "<diária|semanal>"
    target_system: "<sistema externo>"

# ===============================================================
# OBSERVABILIDADE
# ===============================================================
observability:
  metrics:
    - name: "throughput"
      description: "Requisições/segundo"
      unit: "req/s"
    
    - name: "latency"
      description: "Percentis de latência"
      percentiles: ["p50", "p95", "p99"]
    
    - name: "error_rate"
      description: "Percentual de erros"
      unit: "%"
  
  tools:
    metrics: "<Prometheus|Datadog>"
    dashboards: "<Grafana|Kibana>"
    logs: "<ELK Stack|CloudWatch>"
    tracing: "<OpenTelemetry|Jaeger>"
  
  distributed_tracing:
    enabled: true
    correlation_id: true
    spans: ["<componente>", "<subcomponente>", "<conector>"]

# ===============================================================
# SEGURANÇA
# ===============================================================
security:
  authentication:
    method: "<JWT|OAuth2|SAML>"
    provider: "<provider>"
  
  authorization:
    model: "<RBAC|ABAC>"
    groups: ["<N1>", "<N2>", "<Admin>"]
  
  encryption:
    in_transit: "TLS 1.3"
    at_rest: "AES-256"
    secrets_management: "<KMS|Vault>"
  
  multi_tenant:
    enabled: true
    segregation: "logical"  # logical | physical
    tenant_id_field: "tenant_id"

# ===============================================================
# TESTES E QA
# ===============================================================
testing:
  strategy:
    - type: "unit"
      coverage_target: ">80%"
    
    - type: "integration"
      scope: "conectores e eventbus"
    
    - type: "e2e"
      scenarios: "cenários críticos"
    
    - type: "performance"
      load_target: "<X req/s>"
    
    - type: "security"
      scans: ["OWASP Top 10", "pentest"]

# ===============================================================
# FLUXO DE EXECUÇÃO IA-HUMANO
# ===============================================================
execution_flow:
  agents:
    - role: "IA_Architect"
      responsibility: "Gera/atualiza blueprint a partir do SSoT"
      context: "<PROJETO>_CONCEITO_TECH.md"
    
    - role: "IA_Developer"
      responsibility: "Implementa blocos marcados #BLOCK:*"
      context: "<PROJETO>_TECH.md"
    
    - role: "IA_Auditor"
      responsibility: "Valida diffs e SHA256 por artefato"
      context: "Todos os artefatos"
    
    - role: "IA_Governance"
      responsibility: "Verifica conformidade protocolar"
      context: "Todos os artefatos corporativos e de projeto"
    
    - role: "Junta_Validadora"
      responsibility: "Aprova semanticamente"
      context: "Blueprint completo + contexto de negócio"
    
    - role: "Orquestrador_Humano"
      responsibility: "Publica e agenda próximo ciclo"
      context: "Visão estratégica completa"

  workflow:
    - step: 1
      agent: "IA_Architect"
      action: "Gera blueprint"
    
    - step: 2
      agent: "IA_Developer"
      action: "Implementa blocos"
    
    - step: 3
      agent: "IA_Auditor"
      action: "Valida integridade"
    
    - step: 4
      agent: "IA_Governance"
      action: "Valida conformidade"
    
    - step: 5
      agent: "Junta_Validadora"
      action: "Aprova semanticamente"
    
    - step: 6
      agent: "Orquestrador_Humano"
      action: "Publica"

# ===============================================================
# ROADMAP DE IMPLEMENTAÇÃO
# ===============================================================
roadmap:
  phases:
    - version: "v1.0"
      deliverables: ["<Componentes mínimos viáveis>"]
      target_date: "<YYYY-MM-DD>"
      status: "pending"
    
    - version: "v1.1"
      deliverables: ["<Funcionalidades adicionais>"]
      dependencies: ["v1.0"]
      target_date: "<YYYY-MM-DD>"
      status: "planned"
    
    - version: "v2.0"
      deliverables: ["<Otimizações e features avançadas>"]
      dependencies: ["v1.1"]
      target_date: "<YYYY-MM-DD>"
      status: "planned"

# Exemplo DockManager
example_roadmap:
  phases:
    - version: "v1.0"
      deliverables: 
        - "Engine Core + EventBus + Auditoria"
        - "Conectores REST/SQL mínimos"
      target_date: "2025-12-15"
      status: "completed"
    
    - version: "v1.1"
      deliverables:
        - "Biblioteca de Nodes estendida"
        - "Observabilidade avançada"
      dependencies: ["v1.0"]
      target_date: "2026-01-30"
      status: "in_progress"
    
    - version: "v2.0"
      deliverables:
        - "Otimizações de performance"
        - "IA Preditiva acoplada"
      dependencies: ["v1.1"]
      target_date: "2026-03-30"
      status: "planned"

# ===============================================================
# DEPENDÊNCIAS ENTRE BLOCOS/COMPONENTES
# ===============================================================
dependencies:
  graph:
    <BLOCK_1>: []
    <BLOCK_2>: ["<BLOCK_1>"]
    <BLOCK_3>: ["<BLOCK_1>", "<BLOCK_2>"]
  
  critical_path: ["<BLOCK_1>", "<BLOCK_2>", "<BLOCK_3>"]

# ===============================================================
# SLAs E PERFORMANCE
# ===============================================================
slas:
  implementation:
    max_duration_per_block_hours: 16
    review_sla_hours: 48
    rework_sla_hours: 24
  
  runtime:
    max_latency_p95_ms: "<X>"
    max_latency_p99_ms: "<X>"
    throughput_target_rps: "<X>"
    availability_target_percent: "99.9"

# ===============================================================
# METADADOS FINAIS
# ===============================================================
checksum: "pending_commit_sha256"
validated_by:
  - "IA_Architect"
  - "IA_Auditor"
  - "IA_Governance"
  - "Junta_Validadora"
  - "Orquestrador_Humano"

next_review_date: "<YYYY-MM-DD>"

# ===============================================================
# NOTAS DE USO
# ===============================================================
usage_notes: |
  Este YAML é consumido por:
  - IAs para entender estrutura e dependências
  - Pipelines CI/CD para automação
  - Sistemas de auditoria para validação
  
  Mantenha sincronizado com o arquivo .md correspondente.
  Consulte /governance/projects/dockmanager/ para exemplo real.
